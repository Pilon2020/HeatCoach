/* =========================================================
   THEME
   - Auto light/dark via prefers-color-scheme
   - Unified tokens for backgrounds, borders, text, accents
   ========================================================= */

/* Light (default) */
:root{
  --bg:        #eef3ff;
  --card:      #ffffff;
  --surface:   #f6f8ff;
  --line:      #d4ddf4;

  --text:      #0f172a;
  --muted:     #5e6b88;

  --primary:   #3b82f6;
  --primary-2: #2563eb;

  --ok:        #22c55e;
  --warn:      #f59e0b;
  --danger:    #ef4444;
  --weather-bar: #2563eb;

  --ring:      color-mix(in srgb, var(--primary) 35%, transparent);
  --shadow:    0 12px 30px rgba(15, 23, 42, .08);

  --radius: 14px;
  --radius-sm: 10px;

  --slider-track: #c7d2fe;
  --fill-color:   #3b82f6;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:        #050a16;
    --card:      #0f172a;
    --surface:   #131f36;
    --line:      #21304c;

    --text:      #eef2ff;
    --muted:     #9db0d8;

    --primary:   #3b82f6;
    --primary-2: #60a5fa;

    --ok:        #22c55e;
    --warn:      #f59e0b;
    --danger:    #ef4444;
    --weather-bar: #60a5fa;

    --ring:      color-mix(in srgb, var(--primary) 45%, transparent);
    --shadow:    0 18px 40px rgba(0, 0, 0, .45);

    --slider-track: #1f2a44;
    --fill-color:   #3b82f6;
  }
}

/* Motion polish */
* { box-sizing: border-box; }
* { transition: background-color .25s, color .25s, border-color .25s; }
html, body {
  min-height: 100%;
}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background:
    linear-gradient(180deg, var(--bg), var(--bg) 280px, var(--card) 100%);
  color:var(--text);
}

/* =========================================================
   LAYOUT
   ========================================================= */
.container{ max-width:1040px; margin:24px auto; padding:0 16px; }
.hidden{ display:none !important; }

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
}

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:2000;
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px;
  backdrop-filter: blur(8px);
  background: color-mix(in srgb, var(--card) 82%, transparent);
  border-bottom:1px solid var(--line);
}
.brand{ font-weight:700; letter-spacing:.2px; }
.nav{ display:flex; gap:8px; }
.nav-btn{
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--line);
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  cursor: pointer;
}
.nav-btn:hover{ border-color: var(--primary); }
.nav-btn.danger{ background: color-mix(in srgb, var(--danger) 9%, var(--surface)); color: var(--text); }

/* Buttons */
.primary{
  background:var(--primary);
  color:#fff; border:none;
  padding:10px 14px;
  border-radius:var(--radius-sm);
  cursor:pointer; font-weight:600;
}
.primary:hover{ background:var(--primary-2); }
.secondary{
  background:var(--surface);
  color:var(--text);
  border:1px solid var(--line);
  padding:10px 14px; border-radius:var(--radius-sm); cursor:pointer;
}
.secondary.small{ padding:6px 12px; font-size:0.9em; }

/* Tabs */
.tabs{ display:flex; gap:8px; margin-bottom:10px; }
.tab{
  background:var(--surface); border:1px solid var(--line);
  color:var(--text); padding:8px 12px; border-radius:999px; cursor:pointer;
}
.tab.active{ background:var(--primary); color:#fff; border-color:var(--primary); }

/* Simple grids */
.grid-2{ display:grid; grid-template-columns:1fr; gap:16px; }
@media (min-width: 860px){ .grid-2{ grid-template-columns:1fr 1fr; } }

/* =========================================================
   FORMS (Global)
   ========================================================= */
.form{ display:grid; gap:12px; }
label{ display:grid; gap:6px; color:var(--muted); font-size:14px; font-weight:600; }
small{ color:var(--muted); }

/* Minimal input */
input, select{
  background:var(--surface);
  border:1px solid var(--line);
  color:var(--text);
  padding:10px 12px;
  border-radius:var(--radius-sm);
  outline:none;
}
input:focus, select:focus{ border-color:var(--primary); box-shadow:0 0 0 3px var(--ring); }

/* Row helper */
.row{ display:flex; gap:10px; }
.row.two > label{ flex:1; }

.workout-type-picker{
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:16px;
  display:grid;
  gap:12px;
  margin:4px 0 8px;
}
.workout-type-picker legend{
  font-size:0.85rem;
  text-transform:uppercase;
  letter-spacing:0.08em;
  color:var(--muted);
  padding:0 6px;
}
.workout-type-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
}
.workout-type-option{
  position:relative;
  display:flex;
  align-items:flex-start;
  gap:10px;
  padding:12px;
  border:1px solid var(--line);
  border-radius:var(--radius-sm);
  background:var(--surface);
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s;
}
.workout-type-option input{
  position:absolute;
  opacity:0;
  pointer-events:none;
}
.workout-type-option.selected{
  border-color:var(--primary);
  box-shadow:0 0 0 3px var(--ring);
  background:color-mix(in srgb, var(--primary) 6%, var(--surface));
  transform:translateY(-2px);
}
.workout-type-icon{
  font-size:1.4rem;
}
.workout-type-copy{
  display:flex;
  flex-direction:column;
  gap:2px;
}
.workout-type-copy strong{
  color:var(--text);
}
.workout-type-copy small{
  color:var(--muted);
  font-weight:400;
}

/* Range (shared visual) */
input[type="range"]{
  --track-start: #22c55e;    /* default start color */
  --track-end:   #ef4444;    /* default end color */
  --track-base:  var(--line);
  --percent: 0%;
  --fill-color: black/*var(--track-start)*/;
  --thumb-color: var(--fill-color);

  /* Base layout */
  width: 100%;
  height: 18px;
  background: transparent;
  border: 0;
  outline: none;
  padding: 0;
}
input[type="range"]::-webkit-slider-runnable-track{
  height: 6px;
  border-radius: 999px;
  background:
    linear-gradient(to right, var(--fill-color), var(--fill-color)) 0 / var(--percent) 100% no-repeat,
    linear-gradient(to right, var(--track-base), var(--track-base)) 0 / 100% 100% no-repeat;
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none;
  width: 18px; height: 18px; border-radius: 50%;
  background: var(--thumb-color);
  border: 2px solid black;
  margin-top: -6px; /* center on 6px track */
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--thumb-color) 25%, transparent);
}
input[type="range"]::-moz-range-track{
  height: 6px; border-radius: 999px; background: var(--track-base);
}
input[type="range"]::-moz-range-progress{
  height: 6px; border-radius: 999px;
  background: linear-gradient(to right, var(--fill-color), var(--fill-color));
}

/* Thumb */
input[type="range"]::-moz-range-thumb{
  width: 18px; height: 18px; border-radius: 50%;
  background: var(--thumb-color);
  border: 2px solid black;
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--thumb-color) 25%, transparent);
}

/* Optional: focus ring */
input[type="range"]:focus{
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--thumb-color) 30%, transparent);
  border-color: 2px black;
}

/* =========================================================
   LOGS & BADGES
   ========================================================= */
.plan-modal-content{ display:grid; gap:16px; }
.plan-result{
  border:1px solid var(--line);
  border-radius:var(--radius);
  background:var(--surface);
  padding:16px;
  display:grid;
  gap:16px;
}
.plan-result-actions{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  flex-wrap:wrap;
}
.plan-result-note{ margin:4px 0 0; color:var(--muted); font-size:0.9em; }
.plan-result-actions-btns{ display:flex; gap:8px; flex-wrap:wrap; }
.plan-result-body{ display:grid; gap:16px; }
.plan-result-card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  display:grid;
  gap:18px;
  box-shadow:var(--shadow);
}
.plan-result-head{ display:flex; justify-content:space-between; gap:16px; align-items:flex-start; flex-wrap:wrap; }
.plan-result-head h4{ margin:4px 0 0; }
.plan-total-head{ align-items:flex-end; }
.plan-total-stack{ display:flex; flex-direction:column; gap:6px; }
.plan-total-value{ font-size:2.6rem; line-height:1; font-weight:700; }
.plan-total-sub{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  color:var(--muted);
}
.plan-total-sub small{
  font-size:0.85rem;
  letter-spacing:0.05em;
  text-transform:uppercase;
}
.plan-result-meta{ color:var(--muted); font-size:0.9em; }
.eyebrow{ text-transform:uppercase; letter-spacing:0.15em; font-size:0.75rem; color:var(--muted); margin:0; }
.plan-metrics-grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(140px,1fr)); gap:12px; }
.plan-activity-metrics{ margin-top:4px; }
.plan-metrics-grid span{ color:var(--muted); font-size:0.85em; }
.plan-metrics-grid strong{ font-size:1.3em; }
.plan-block{ border:1px solid var(--line); border-radius:var(--radius-sm); padding:14px; background:var(--surface); display:grid; gap:8px; }
.plan-block-title{ font-weight:600; text-transform:uppercase; font-size:0.78rem; color:var(--muted); }
.plan-guidance p{ margin:0; color:var(--muted); }
.plan-guidance p + p{ margin-top:6px; }
.plan-guidance strong{ color:var(--text); }
.plan-list{ margin:0; padding-left:18px; display:grid; gap:4px; }
.plan-schedule{ margin:0; padding-left:18px; display:grid; gap:8px; }
.plan-schedule li{ display:flex; justify-content:space-between; gap:16px; padding:4px 0; border-bottom:1px solid color-mix(in srgb, var(--line) 80%, transparent); }
.plan-schedule li:last-child{ border-bottom:none; }
.plan-schedule span{ font-weight:600; }
.plan-schedule small{ color:var(--muted); }

.daily-card{ margin-bottom:16px; }
.daily-grid{ display:grid; grid-template-columns:1fr 1fr; gap:18px; align-items:stretch; }
.daily-grid .hydration-panel{ grid-column: 1 / -1; }
@media (max-width: 720px){
  .daily-grid{ grid-template-columns:1fr; }
}
.daily-card-info{ display:grid; gap:10px; }
.urine-panel{
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:16px;
  background:var(--surface);
  display:grid;
  gap:12px;
  transition:box-shadow .3s;
}
.urine-panel.flash-success{
  animation: urineFlash .9s ease;
}
@keyframes urineFlash{
  0%{ box-shadow:0 0 0 0 rgba(34,197,94,.55); }
  100%{ box-shadow:0 0 0 22px rgba(34,197,94,0); }
}
.urine-panel-head{ display:flex; justify-content:space-between; gap:16px; flex-wrap:wrap; align-items:flex-start; }
.urine-latest{
  font-size:0.85em;
  color:var(--muted);
  padding:6px 12px;
  border-radius:999px;
  background:color-mix(in srgb, var(--primary) 15%, var(--surface));
  border:2px solid #000;
  min-width:180px;
  transition:background .3s ease, color .3s ease;
}
.urine-slider-wrap{ display:grid; gap:8px;}
.urine-scale{ display:flex; justify-content:space-between; color:var(--muted); font-size:0.85em; }
.urine-panel-actions{ display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
.urine-pill{
  padding:4px 12px;
  border-radius:999px;
  border:1px solid var(--line);
  font-weight:600;
  display:inline-block;
}
.link-btn{
  background:none;
  border:none;
  color:var(--primary);
  cursor:pointer;
  padding:4px 0;
  font-weight:600;
}
.link-btn:hover{ text-decoration:underline; }
.link-btn.small{ font-size:0.85em; }

.urine-slider::-webkit-slider-runnable-track{
  background: linear-gradient(to right,
    #000000 0%,
    #f2f5b0 12%,
    #ecef96 24%,
    #e6e06a 36%,
    #ddc34d 48%,
    #d1a83a 60%,
    #c18a2c 72%,
    #ab6b23 84%,
    #924c19 92%,
    #783512 100%);
  border-radius:999px;
  box-sizing:border-box;
}
.urine-slider::-moz-range-track{
  background: linear-gradient(to right,
    #000000 0%,
    #f2f5b0 12%,
    #ecef96 24%,
    #e6e06a 36%,
    #ddc34d 48%,
    #d1a83a 60%,
    #c18a2c 72%,
    #ab6b23 84%,
    #924c19 92%,
    #783512 100%);
  border-radius:999px;
  box-sizing:border-box;
}

.hydration-panel{
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:12px;
  background:var(--surface);
  display:grid;
  gap:10px;
}
.hydration-head{
  display:flex;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
  align-items:flex-start;
}
.hydration-head h4{ font-size:1.1rem; margin:0; }
.hydration-head .eyebrow{ font-size:0.7rem; }
.hydration-goal-row{
  display:flex;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
  align-items:flex-end;
}
.hydration-goal-row strong{ font-size:1.2rem; }
.hydration-goal-meta{ font-size:0.8em; text-align:right; }
.hydration-bar{
  position:relative;
  width:100%;
  height:12px;
  border-radius:999px;
  background:color-mix(in srgb, var(--line) 55%, transparent);
  overflow:hidden;
}
.hydration-bar-fill{
  position:absolute;
  inset:0;
  width:var(--fill, 0%);
  background:linear-gradient(90deg, var(--primary), var(--ok));
  border-radius:inherit;
  transition:width .3s ease;
}
.hydration-stats{
  display:flex;
  justify-content:space-between;
  gap:16px;
  flex-wrap:wrap;
}
.hydration-stats strong{
  display:block;
  font-size:1.15rem;
}
.hydration-stats small{
  display:block;
  margin-top:2px;
  font-size:0.8em;
}
.hydration-quick{
  display:grid;
  gap:8px;
  border-top:1px solid color-mix(in srgb, var(--line) 65%, transparent);
  padding-top:8px;
  position:relative;
}
.hydration-quick-head{
  display:flex;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
  align-items:center;
  font-size:0.8em;
  color:var(--muted);
}
.hydration-quick-grid{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:8px;
}
.hydration-preset-btn{
  background:var(--surface);
  border:1px solid var(--line);
  border-radius:var(--radius-sm);
  padding:10px 12px;
  cursor:pointer;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:4px;
  transition:all .2s ease;
  text-align:center;
}
.hydration-preset-btn:hover{
  border-color:var(--primary);
  background:color-mix(in srgb, var(--primary) 8%, var(--surface));
  transform:translateY(-1px);
}
.hydration-preset-btn:disabled{
  opacity:0.5;
  cursor:not-allowed;
  transform:none;
}
.hydration-preset-btn .preset-label{
  font-size:0.75em;
  color:var(--muted);
  text-transform:uppercase;
  letter-spacing:0.05em;
}
.hydration-preset-btn .preset-value{
  font-size:1.1rem;
  font-weight:600;
  color:var(--text);
}
.hydration-edit-mode{
  border-top:1px solid color-mix(in srgb, var(--line) 65%, transparent);
  padding-top:10px;
  margin-top:4px;
  display:grid;
  gap:10px;
}
.hydration-edit-grid{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:10px;
}
.hydration-edit-item{
  display:grid;
  gap:6px;
}
.hydration-edit-item label{
  font-size:0.8em;
  color:var(--muted);
}
.hydration-edit-controls{
  display:flex;
  align-items:center;
  gap:6px;
}
.hydration-edit-input{
  flex:1;
  padding:6px 8px;
  font-size:0.9em;
}
.hydration-edit-controls .unit{
  min-width:32px;
  text-align:center;
  font-weight:600;
  color:var(--muted);
  font-size:0.85em;
}
.hydration-edit-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:4px;
}
.urine-slider::-moz-range-progress{ background: transparent; }
.urine-slider{
  appearance:none;
  -webkit-appearance:none;
  border:0;
  padding:0;
  background:transparent;
  outline: 2px solid black;
  outline-offset: 1px;
}
.urine-slider:focus{
  outline: none;
}
.urine-slider::-webkit-slider-thumb{
  border:2px solid #000;
}
.urine-slider::-moz-range-thumb{
  border:2px solid #000;
}

.metric-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:16px;
  margin-top:20px;
}
.metric-chart{
  width:100%;
  height:220px;
  background:transparent;
  border:none;
  border-radius:0;
}
.empty-state{
  color:var(--muted);
  font-style:italic;
  margin:8px 0;
}

.weather-status{
  margin:8px 0;
  padding:8px;
  border-radius:8px;
  font-size:0.9em;
  background:var(--weather-bar);
  color:#fff;
}

.logs{ margin-top:14px; display:grid; gap:10px; }
.log-item{
  display:grid; gap:6px; padding:12px;
  border:1px solid var(--line); border-radius:var(--radius-sm);
  background:var(--card);
}
.badge{
  display:inline-block; padding:4px 8px; border-radius:999px;
  border:1px solid var(--line); background:var(--surface); color:var(--text); font-size:12px;
}
.badge.ok{ border-color: color-mix(in srgb, var(--ok) 35%, var(--line)); background: color-mix(in srgb, var(--ok) 10%, var(--surface)); }
.badge.warn{ border-color: color-mix(in srgb, var(--warn) 35%, var(--line)); background: color-mix(in srgb, var(--warn) 10%, var(--surface)); }
.badge.danger{ border-color: color-mix(in srgb, var(--danger) 35%, var(--line)); background: color-mix(in srgb, var(--danger) 10%, var(--surface)); }

/* Graphs layout */
.graphs-view{
  padding:0;
  background:transparent;
  border:none;
  box-shadow:none;
}
.graphs-header{
  padding:8px 6px 22px;
}
.graphs-header h3{
  margin:4px 0;
  font-size:1.6rem;
}
.graphs-header p{
  margin:4px 0 0;
  color:var(--muted);
}
.graphs-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:18px;
  margin-top:6px;
}
.graph-card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  display:flex;
  flex-direction:column;
  gap:12px;
  box-shadow:var(--shadow);
  min-height:280px;
}
.graph-card-head{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
}
.graph-card-head h4{
  margin:0;
}
.graph-card-head small{
  color:var(--muted);
  display:block;
  margin-top:4px;
}
.graph-card.span-2{
  grid-column:span 2;
}
@media (max-width: 760px){
  .graph-card.span-2{
    grid-column:span 1;
  }
}
.graph-card canvas{
  width:100%;
  flex:1;
  min-height:220px;
  background:transparent;
}
.graph-card.span-2 canvas{
  min-height:320px;
}
/* =========================================================
   PROFILE
   ========================================================= */
.profile-view{
  padding:0;
  background:transparent;
  border:none;
  box-shadow:none;
}
.profile-display{ display:flex; flex-direction:column; gap:24px; }
.profile-hero{
  --accent: var(--profile-accent, #2563eb);
  background:linear-gradient(125deg, var(--accent), color-mix(in srgb, var(--accent) 55%, #0f172a));
  color:#fff;
  padding:28px;
  border-radius:var(--radius);
  margin:0 20px;
  box-shadow:0 18px 40px rgba(15,23,42,.35);
}
.profile-hero-content{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:20px;
  flex-wrap:wrap;
}
.profile-avatar{
  width:72px; height:72px;
  border-radius:20px;
  background:rgba(255,255,255,.18);
  border:2px solid rgba(255,255,255,.45);
  display:grid; place-items:center;
  font-size:1.8rem; font-weight:700;
}
.profile-identity{ display:flex; flex-direction:column; gap:6px; max-width:420px; }
.profile-name{ margin:0; font-size:2.1rem; }
.profile-tagline{ margin:0; color:rgba(255,255,255,.75); font-size:0.95rem; }
.profile-meta{ display:flex; gap:12px; flex-wrap:wrap; font-size:0.95rem; opacity:0.85; }
.profile-meta span{ display:flex; align-items:center; gap:6px; }
.profile-hero-badges{
  margin-top:20px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:12px;
}
.profile-hero-badges div{
  background:rgba(15,23,42,.28);
  border:1px solid rgba(255,255,255,.25);
  border-radius:var(--radius-sm);
  padding:12px;
}
.profile-panels{ display:flex; flex-direction:column; gap:18px; padding:0 20px 28px; }
.profile-panel{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
}
.profile-grid{
  margin-top:12px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:12px;
}
.profile-stat{
  border:1px solid color-mix(in srgb, var(--line) 70%, transparent);
  border-radius:var(--radius-sm);
  padding:12px;
  background:var(--surface);
  display:flex;
  flex-direction:column;
  gap:4px;
}
.profile-stat strong{ font-size:1.2rem; }
.profile-form{
  margin-top:20px;
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:20px;
  background:var(--card);
  box-shadow:var(--shadow);
}
.profile-form-head{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap:16px;
  flex-wrap:wrap;
}
.profile-form-actions{ display:flex; gap:10px; }
.profile-fieldset{
  margin-top:18px;
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  display:grid;
  gap:14px;
}
.profile-fieldset legend{
  padding:0 6px;
  font-weight:600;
  color:var(--muted);
}
.profile-switches{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-top:6px;
}
.switch{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:600;
  cursor:pointer;
}
.switch input{ width:18px; height:18px; }
.profile-form.hidden{ display:none !important; }
.profile-view .hidden{ display:none !important; }
@media (max-width:720px){
  .profile-hero{ margin:0; border-radius:0; }
  .profile-panels{ padding:0 0 24px; }
  .profile-form{ padding:16px; }
}


/* Density preference */
body.density-compact .container{ margin:16px auto; }
body.density-compact .card,
body.density-compact .profile-panel,
body.density-compact .profile-form,
body.density-compact .modal{ padding:14px; }
body.density-compact .profile-hero{ padding:20px; margin:0 12px; }
body.density-compact .profile-grid{ gap:8px; }
body.density-compact .form{ gap:8px; }
body.density-compact .nav-btn,
body.density-compact .primary,
body.density-compact .secondary{ padding:7px 10px; }
body.density-compact input,
body.density-compact select{ padding:8px 10px; }
body.density-compact .plan-result-card,
body.density-compact .plan-block{ padding:12px; }
body.density-compact .profile-fieldset{ padding:14px; }
body.density-compact .profile-panels{ gap:12px; }
body.density-compact .daily-card{ margin-bottom:10px; }
body.density-compact .calendar{ padding:8px; }


/* =========================================================
   CALENDAR
   ========================================================= */
.calendar{
  border:1px solid var(--line); border-radius:var(--radius);
  background:var(--card); padding:10px; box-shadow:var(--shadow);
}
.cal-header{ color:var(--muted); margin-bottom:8px; text-align:center; }
.cal-header .nav{ display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.cal-header .nav .btn{ background:var(--surface); color:var(--text); border:1px solid var(--line); padding:6px 10px; border-radius:var(--radius-sm); cursor:pointer; }
.cal-header .nav .btn:disabled{ opacity:.5; cursor:not-allowed; }

.cal-grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:6px; }
.cal-cell{
  position:relative; display:flex; flex-direction:column;
  border:1px solid var(--line); border-radius:10px;
  background:var(--surface); padding:6px; overflow:hidden; min-height:100px;
}
.cal-cell .day-row{ display:flex; align-items:center; justify-content:space-between; }
.cal-cell .day{ font-size:11px; color:var(--muted); }
.cal-cell .logs-mini{ margin-top:4px; display:grid; gap:4px; overflow:auto; }
.cal-cell .log-chip{
  font-size:11px; background:var(--card); border:1px solid var(--line); color:var(--text);
  border-radius:6px; padding:2px 6px; cursor:pointer;
}
.cal-cell .log-chip:hover{ border-color:var(--primary); }

/* day status tints */
.cal-cell.low{ background: color-mix(in srgb, var(--danger) 8%, var(--surface)); }
.cal-cell.mid{ background: color-mix(in srgb, var(--warn) 8%, var(--surface)); }
.cal-cell.high{ background: color-mix(in srgb, var(--ok) 8%, var(--surface)); }

.cal-cell.empty{ background:transparent; border-color:transparent; }
.cal-cell.disabled{ opacity:.4; pointer-events:none; }
.cal-cell.today{ outline:2px solid var(--primary); outline-offset:2px; }
.cal-cell .dot{
  position:absolute; left:6px; bottom:6px; width:8px; height:8px; border-radius:50%;
  background:var(--primary);
  box-shadow:0 0 0 2px color-mix(in srgb, var(--primary) 25%, transparent);
}

/* Larger calendar variant */
.calendar.large{ padding:14px; }
.calendar.large .cal-grid{ gap:8px; }
.calendar.large .cal-cell{ min-height:110px; }

/* =========================================================
   MODAL (Shared)
   ========================================================= */
.modal-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.45);
  display:flex; align-items:center; justify-content:center; z-index:1000;
}
.modal{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  width:min(560px, 92vw);
  max-height:85vh; overflow:auto;
  box-shadow:var(--shadow);
}
.modal-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px;
  border-bottom:1px solid var(--line);
}
.modal-content{ padding:14px; color:var(--text); }
.modal-footer{
  padding:12px 16px; border-top:1px solid var(--line);
  display:flex; justify-content:flex-end; gap:8px;
}
.icon-btn{
  background:transparent; border:1px solid var(--line); color:var(--text);
  padding:6px 10px; border-radius:var(--radius-sm); cursor:pointer;
}
.icon-btn:hover{ border-color:var(--primary); }

/* =========================================================
   DAILY TRACKER (Decluttered & aligned with app)
   ========================================================= */

/* Understated section blocks for readability */
#daily-modal .form .section{
  margin-top:8px; padding-top:6px;
  border-top:1px dashed var(--line);
}

/* Use compact two-column grid on desktop, single column on small screens */
#daily-modal .form .row.two{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px 18px;
}
@media (max-width: 720px){
  #daily-modal .form .row.two{ grid-template-columns:1fr; }
}

/* Convert dense inputs to “underlined” minimalist style to reduce visual weight */
#daily-modal .form input[type="text"],
#daily-modal .form input[type="number"],
#daily-modal .form input[type="date"],
#daily-modal .form input[type="time"],
#daily-modal .form select{
  background:transparent;
  border:none; border-bottom:2px solid var(--line);
  padding:8px 2px 10px; border-radius:0;
}
#daily-modal .form input:focus,
#daily-modal .form select:focus{
  border-color:var(--primary); box-shadow:0 4px 0 -2px var(--primary) inset;
}

/* Segmented controls (replace some sliders visually, keep values in hidden inputs) */
.segment-row{
  display:grid; grid-template-columns:210px 1fr; align-items:center;
  gap:12px; margin:8px 0;
}
.segment-label{ font-size:16px; font-weight:700; color:var(--text); }
.segment-label small{ display:block; font-size:12px; color:var(--muted); margin-top:2px; }

.segment-group{
  display:grid; grid-template-columns:repeat(4,1fr); gap:10px;
}
.segment-group.is-5{ grid-template-columns:repeat(5,1fr); }

.segment{
  appearance:none; cursor:pointer;
  border:1px solid var(--line);
  background:var(--surface);
  color:var(--text); font-weight:800; letter-spacing:.2px;
  padding:10px 8px; border-radius:12px;
  box-shadow:var(--shadow);
  transition:transform .04s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
.segment:hover{ transform:translateY(-1px); }
.segment:focus-visible{ outline:2px solid var(--primary); outline-offset:2px; }
.segment.is-active{
  background:#fff; border-color:var(--primary);
  box-shadow:0 0 0 2px var(--ring);
}

/* Notes input wider spacing to breathe */
#daily-modal #dt-notes{ padding-top:12px; }

/* Modal action row spacing consistency */
#daily-modal .modal-footer{ margin-top:6px; }

/* =========================================================
   UTILITIES
   ========================================================= */
.u-muted{ color:var(--muted); }
.u-center{ display:grid; place-items:center; }
.u-divider{ border-top:1px solid var(--line); margin:10px 0; }
